<template>
  <div class="demo">
    <div class="header">
      <span class="icon">âš ï¸</span>
      <span class="title">é”™è¯¯å“åº”è®¾è®¡è¿›é˜¶</span>
    </div>

    <div class="tabs">
      <button
        v-for="tab in tabs"
        :key="tab.id"
        :class="['tab', { active: active === tab.id }]"
        @click="active = tab.id"
      >
        {{ tab.icon }} {{ tab.name }}
      </button>
    </div>

    <div class="content">
      <div v-if="active === 'validate'" class="section">
        <h4>å‚æ•°æ ¡éªŒé”™è¯¯</h4>
        <pre class="code-block">{
  "code": 10001,
  "message": "å‚æ•°æ ¡éªŒå¤±è´¥",
  "data": {
    "errors": [
      {
        "field": "email",
        "message": "é‚®ç®±æ ¼å¼ä¸æ­£ç¡®",
        "value": "invalid-email"
      },
      {
        "field": "password",
        "message": "å¯†ç é•¿åº¦è‡³å°‘ 8 ä½",
        "value": "123"
      }
    ]
  }
}</pre>
        <div class="field-tips">
          <div class="tip-row">
            <code>field</code>
            <span>å‡ºé”™å­—æ®µåï¼Œå‰ç«¯å¯å®šä½è¡¨å•</span>
          </div>
          <div class="tip-row">
            <code>message</code>
            <span>ç”¨æˆ·å‹å¥½çš„é”™è¯¯æè¿°</span>
          </div>
          <div class="tip-row">
            <code>value</code>
            <span>å®¢æˆ·ç«¯æäº¤çš„å€¼ï¼ˆå¯é€‰ï¼‰</span>
          </div>
        </div>
      </div>

      <div v-if="active === 'business'" class="section">
        <h4>ä¸šåŠ¡é”™è¯¯</h4>
        <pre class="code-block">{
  "code": 20001,
  "message": "ä½™é¢ä¸è¶³",
  "data": {
    "current_balance": 50.00,
    "required_amount": 99.00,
    "shortfall": 49.00,
    "suggestion": "è¯·å……å€¼åé‡è¯•"
  }
}</pre>
        <div class="business-tips">
          <div class="b-tip">âœ“ è¿”å›å½“å‰çŠ¶æ€æ•°æ®ï¼Œä¾¿äºå‰ç«¯å±•ç¤º</div>
          <div class="b-tip">âœ“ æä¾› suggestion ç»™å‡ºè§£å†³å»ºè®®</div>
          <div class="b-tip">âœ“ æ•°æ®ç»“æ„åŒ–ï¼Œå‰ç«¯å¯çµæ´»å±•ç¤º</div>
        </div>
      </div>

      <div v-if="active === 'layers'" class="section">
        <h4>é”™è¯¯ç åˆ†å±‚è®¾è®¡</h4>
        <div class="layer-list">
          <div
            v-for="layer in layers"
            :key="layer.range"
            class="layer-item"
          >
            <div class="layer-range">{{ layer.range }}</div>
            <div class="layer-info">
              <div class="layer-name">{{ layer.name }}</div>
              <div class="layer-example">ç¤ºä¾‹ï¼š{{ layer.example }}</div>
            </div>
            <div class="layer-desc">{{ layer.desc }}</div>
          </div>
        </div>
        <div class="layer-note">é”™è¯¯ç ä»å¤–åˆ°å†…ï¼šç³»ç»Ÿ â†’ æœåŠ¡ â†’ ä¸šåŠ¡ â†’ è®¤è¯ â†’ å‚æ•°</div>
      </div>

      <div v-if="active === 'http'" class="section">
        <h4>HTTP çŠ¶æ€ç  vs ä¸šåŠ¡çŠ¶æ€ç </h4>
        <div class="http-compare">
          <div class="http-col">
            <div class="http-title">HTTP çŠ¶æ€ç </div>
            <div class="http-desc">ä¼ è¾“å±‚çŠ¶æ€</div>
            <div class="http-codes">
              <div class="http-code">
                <span class="code-num">2xx</span>
                <span>è¯·æ±‚æˆåŠŸ</span>
              </div>
              <div class="http-code">
                <span class="code-num">4xx</span>
                <span>å®¢æˆ·ç«¯é”™è¯¯</span>
              </div>
              <div class="http-code">
                <span class="code-num">5xx</span>
                <span>æœåŠ¡ç«¯é”™è¯¯</span>
              </div>
            </div>
          </div>
          <div class="http-arrow">â†’</div>
          <div class="http-col">
            <div class="http-title">ä¸šåŠ¡çŠ¶æ€ç </div>
            <div class="http-desc">ä¸šåŠ¡å±‚çŠ¶æ€</div>
            <div class="http-codes">
              <div class="http-code">
                <span class="code-num">0</span>
                <span>ä¸šåŠ¡æˆåŠŸ</span>
              </div>
              <div class="http-code">
                <span class="code-num">1xxxx</span>
                <span>å‚æ•°é”™è¯¯</span>
              </div>
              <div class="http-code">
                <span class="code-num">2xxxx</span>
                <span>ä¸šåŠ¡é”™è¯¯</span>
              </div>
            </div>
          </div>
        </div>
        <div class="http-note">HTTP 200 + ä¸šåŠ¡é”™è¯¯ç  æ˜¯ä¸šç•Œä¸»æµåšæ³•</div>
      </div>

      <div v-if="active === 'examples'" class="section">
        <h4>å¸¸è§é”™è¯¯ç ç¤ºä¾‹</h4>
        <div class="ex-tabs">
          <button
            v-for="ex in examples"
            :key="ex.id"
            :class="['ex-tab', { active: exId === ex.id }]"
            @click="exId = ex.id"
          >
            {{ ex.name }}
          </button>
        </div>
        <div class="ex-content">
          <div class="ex-list">
            <div
              v-for="item in currentExample.items"
              :key="item.code"
              class="ex-row"
            >
              <code class="ex-code">{{ item.code }}</code>
              <span class="ex-msg">{{ item.message }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="tips">
      <span class="tips-icon">ğŸ’¡</span>
      <span class="tips-text">é”™è¯¯ä¿¡æ¯è¦"æœºå™¨å¯è¯» + äººç±»å‹å¥½"ï¼Œä¾¿äºå‰ç«¯ç»Ÿä¸€å¤„ç†</span>
    </div>
  </div>
</template>

<script setup>
import { ref, computed } from 'vue'

const active = ref('validate')
const exId = ref('param')

const tabs = [
  { id: 'validate', icon: 'ğŸ”', name: 'å‚æ•°æ ¡éªŒ' },
  { id: 'business', icon: 'ğŸ’¼', name: 'ä¸šåŠ¡é”™è¯¯' },
  { id: 'layers', icon: 'ğŸ“Š', name: 'åˆ†å±‚è®¾è®¡' },
  { id: 'http', icon: 'ğŸŒ', name: 'HTTPå¯¹æ¯”' },
  { id: 'examples', icon: 'ğŸ“‹', name: 'å¸¸è§ç¤ºä¾‹' }
]

const layers = [
  { range: '50001-59999', name: 'ç³»ç»Ÿå±‚', example: '50001 æ•°æ®åº“å¼‚å¸¸', desc: 'åŸºç¡€è®¾æ–½é—®é¢˜' },
  { range: '40001-49999', name: 'æœåŠ¡å±‚', example: '40001 ç¬¬ä¸‰æ–¹æœåŠ¡è¶…æ—¶', desc: 'å¤–éƒ¨ä¾èµ–é—®é¢˜' },
  { range: '30001-39999', name: 'è®¤è¯å±‚', example: '30001 æœªç™»å½•', desc: 'èº«ä»½æƒé™é—®é¢˜' },
  { range: '20001-29999', name: 'ä¸šåŠ¡å±‚', example: '20001 ä½™é¢ä¸è¶³', desc: 'ä¸šåŠ¡è§„åˆ™æ ¡éªŒ' },
  { range: '10001-19999', name: 'å‚æ•°å±‚', example: '10001 å‚æ•°ç¼ºå¤±', desc: 'å®¢æˆ·ç«¯è¾“å…¥é—®é¢˜' }
]

const examples = [
  {
    id: 'param',
    name: 'å‚æ•°å±‚',
    items: [
      { code: 10001, message: 'ç¼ºå°‘å¿…å¡«å‚æ•°' },
      { code: 10002, message: 'å‚æ•°æ ¼å¼é”™è¯¯' },
      { code: 10003, message: 'å‚æ•°é•¿åº¦è¶…é™' },
      { code: 10004, message: 'å‚æ•°å€¼éæ³•' }
    ]
  },
  {
    id: 'auth',
    name: 'è®¤è¯å±‚',
    items: [
      { code: 30001, message: 'æœªç™»å½•' },
      { code: 30002, message: 'ç™»å½•å·²è¿‡æœŸ' },
      { code: 30003, message: 'æ— æƒé™è®¿é—®' },
      { code: 30004, message: 'è´¦å·å·²è¢«ç¦ç”¨' }
    ]
  },
  {
    id: 'biz',
    name: 'ä¸šåŠ¡å±‚',
    items: [
      { code: 20001, message: 'ä½™é¢ä¸è¶³' },
      { code: 20002, message: 'å•†å“å·²ä¸‹æ¶' },
      { code: 20003, message: 'è®¢å•å·²å–æ¶ˆ' },
      { code: 20004, message: 'åº“å­˜ä¸è¶³' }
    ]
  },
  {
    id: 'sys',
    name: 'ç³»ç»Ÿå±‚',
    items: [
      { code: 50001, message: 'æ•°æ®åº“å¼‚å¸¸' },
      { code: 50002, message: 'ç¼“å­˜æœåŠ¡å¼‚å¸¸' },
      { code: 50003, message: 'ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨åé‡è¯•' }
    ]
  }
]

const currentExample = computed(() => {
  return examples.find(e => e.id === exId.value) || examples[0]
})
</script>

<style scoped>
.demo {
  border: 1px solid var(--vp-c-divider);
  border-radius: 12px;
  background: var(--vp-c-bg-soft);
  margin: 24px 0;
  overflow: hidden;
}

.header {
  padding: 14px 20px;
  background: var(--vp-c-bg);
  border-bottom: 1px solid var(--vp-c-divider);
  display: flex;
  align-items: center;
  gap: 10px;
}

.icon {
  font-size: 20px;
}

.title {
  font-weight: 600;
  font-size: 15px;
}

.tabs {
  display: flex;
  gap: 4px;
  padding: 10px 12px;
  background: var(--vp-c-bg);
  border-bottom: 1px solid var(--vp-c-divider);
  overflow-x: auto;
}

.tab {
  padding: 6px 12px;
  border: 1px solid var(--vp-c-divider);
  border-radius: 6px;
  background: var(--vp-c-bg-soft);
  font-size: 12px;
  font-weight: 500;
  cursor: pointer;
  white-space: nowrap;
  transition: all 0.2s;
}

.tab:hover {
  border-color: var(--vp-c-brand);
}

.tab.active {
  background: var(--vp-c-brand);
  border-color: var(--vp-c-brand);
  color: white;
}

.content {
  padding: 16px;
}

.section h4 {
  margin: 0 0 12px 0;
  font-size: 14px;
}

.code-block {
  background: #1e293b;
  color: #e2e8f0;
  padding: 12px;
  border-radius: 6px;
  font-family: 'Menlo', monospace;
  font-size: 11px;
  line-height: 1.5;
  overflow-x: auto;
  margin: 0;
}

.field-tips {
  margin-top: 12px;
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.tip-row {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 8px 12px;
  background: var(--vp-c-bg);
  border-radius: 6px;
}

.tip-row code {
  background: var(--vp-c-bg-soft);
  padding: 2px 8px;
  border-radius: 4px;
  font-size: 12px;
  color: var(--vp-c-brand);
  min-width: 70px;
}

.tip-row span {
  font-size: 12px;
  color: var(--vp-c-text-2);
}

.business-tips {
  margin-top: 12px;
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.b-tip {
  font-size: 12px;
  color: var(--vp-c-text-2);
  padding: 6px 10px;
  background: var(--vp-c-bg);
  border-radius: 4px;
}

.layer-list {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.layer-item {
  display: grid;
  grid-template-columns: 100px 1fr auto;
  gap: 12px;
  align-items: center;
  padding: 10px 12px;
  background: var(--vp-c-bg);
  border: 1px solid var(--vp-c-divider);
  border-radius: 6px;
}

@media (max-width: 640px) {
  .layer-item {
    grid-template-columns: 1fr;
    gap: 6px;
  }
}

.layer-range {
  font-family: monospace;
  font-size: 12px;
  font-weight: 600;
  color: var(--vp-c-brand);
  background: var(--vp-c-bg-soft);
  padding: 4px 8px;
  border-radius: 4px;
  text-align: center;
}

.layer-name {
  font-size: 13px;
  font-weight: 600;
}

.layer-example {
  font-size: 11px;
  color: var(--vp-c-text-3);
}

.layer-desc {
  font-size: 11px;
  color: var(--vp-c-text-2);
  background: color-mix(in srgb, var(--vp-c-brand) 10%, transparent);
  padding: 4px 8px;
  border-radius: 4px;
}

.layer-note {
  margin-top: 12px;
  font-size: 12px;
  color: var(--vp-c-text-2);
  padding: 8px 12px;
  background: var(--vp-c-bg);
  border-radius: 6px;
}

.http-compare {
  display: flex;
  align-items: stretch;
  gap: 12px;
}

@media (max-width: 640px) {
  .http-compare {
    flex-direction: column;
  }
  
  .http-arrow {
    display: none;
  }
}

.http-col {
  flex: 1;
  padding: 12px;
  background: var(--vp-c-bg);
  border: 1px solid var(--vp-c-divider);
  border-radius: 8px;
}

.http-title {
  font-size: 13px;
  font-weight: 600;
  margin-bottom: 4px;
}

.http-desc {
  font-size: 11px;
  color: var(--vp-c-text-3);
  margin-bottom: 10px;
}

.http-arrow {
  display: flex;
  align-items: center;
  font-size: 20px;
  color: var(--vp-c-text-3);
}

.http-codes {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.http-code {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 12px;
}

.code-num {
  font-family: monospace;
  font-weight: 600;
  color: var(--vp-c-brand);
  min-width: 50px;
}

.http-note {
  margin-top: 12px;
  font-size: 12px;
  color: var(--vp-c-text-2);
  padding: 8px 12px;
  background: color-mix(in srgb, #22c55e 10%, var(--vp-c-bg));
  border-radius: 6px;
}

.ex-tabs {
  display: flex;
  gap: 4px;
  margin-bottom: 12px;
  flex-wrap: wrap;
}

.ex-tab {
  padding: 5px 10px;
  border: 1px solid var(--vp-c-divider);
  border-radius: 4px;
  background: var(--vp-c-bg);
  font-size: 11px;
  cursor: pointer;
  transition: all 0.2s;
}

.ex-tab:hover {
  border-color: var(--vp-c-brand);
}

.ex-tab.active {
  background: var(--vp-c-brand);
  border-color: var(--vp-c-brand);
  color: white;
}

.ex-list {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.ex-row {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 8px 12px;
  background: var(--vp-c-bg);
  border-radius: 6px;
}

.ex-code {
  font-family: monospace;
  font-size: 12px;
  font-weight: 600;
  color: var(--vp-c-brand);
  background: var(--vp-c-bg-soft);
  padding: 2px 8px;
  border-radius: 4px;
  min-width: 50px;
  text-align: center;
}

.ex-msg {
  font-size: 12px;
  color: var(--vp-c-text-2);
}

.tips {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 10px 16px;
  background: var(--vp-c-bg);
  border-top: 1px solid var(--vp-c-divider);
}

.tips-icon {
  font-size: 14px;
}

.tips-text {
  font-size: 12px;
  color: var(--vp-c-text-2);
}
</style>
