<template>
  <div class="tcp-udp-comparison">
    <div class="comparison-grid">
      <div class="protocol-card tcp">
        <div class="protocol-header">
          <div class="protocol-icon">ğŸ”’</div>
          <div class="protocol-title">TCP</div>
          <div class="protocol-subtitle">ä¼ è¾“æ§åˆ¶åè®®</div>
        </div>

        <div class="protocol-features">
          <div class="feature-item good">
            <div class="feature-icon">âœ“</div>
            <div class="feature-text">å¯é ä¼ è¾“</div>
          </div>
          <div class="feature-item good">
            <div class="feature-icon">âœ“</div>
            <div class="feature-text">é¢å‘è¿æ¥</div>
          </div>
          <div class="feature-item good">
            <div class="feature-icon">âœ“</div>
            <div class="feature-text">æµé‡æ§åˆ¶</div>
          </div>
          <div class="feature-item good">
            <div class="feature-icon">âœ“</div>
            <div class="feature-text">æ‹¥å¡æ§åˆ¶</div>
          </div>
          <div class="feature-item bad">
            <div class="feature-icon">âœ—</div>
            <div class="feature-text">é€Ÿåº¦è¾ƒæ…¢</div>
          </div>
          <div class="feature-item bad">
            <div class="feature-icon">âœ—</div>
            <div class="feature-text">å¼€é”€è¾ƒå¤§</div>
          </div>
        </div>

        <div class="protocol-example">
          <div class="example-title">åº”ç”¨åœºæ™¯</div>
          <div class="example-tags">
            <span class="tag">ç½‘é¡µæµè§ˆ</span>
            <span class="tag">æ–‡ä»¶ä¼ è¾“</span>
            <span class="tag">é‚®ä»¶å‘é€</span>
          </div>
        </div>

        <div class="handshake-demo">
          <div class="demo-title">ä¸‰æ¬¡æ¡æ‰‹</div>
          <div class="handshake-steps">
            <div class="step" :class="{ active: tcpStep >= 1 }">
              <div class="step-arrow">â†’</div>
              <div class="step-text">SYN</div>
            </div>
            <div class="step" :class="{ active: tcpStep >= 2 }">
              <div class="step-arrow">â†</div>
              <div class="step-text">SYN-ACK</div>
            </div>
            <div class="step" :class="{ active: tcpStep >= 3 }">
              <div class="step-arrow">â†’</div>
              <div class="step-text">ACK</div>
            </div>
          </div>
          <button class="demo-btn" @click="startTcpHandshake">
            {{ tcpStep === 0 ? 'æ¼”ç¤ºæ¡æ‰‹' : 'é‡æ–°æ¼”ç¤º' }}
          </button>
        </div>
      </div>

      <div class="protocol-card udp">
        <div class="protocol-header">
          <div class="protocol-icon">âš¡</div>
          <div class="protocol-title">UDP</div>
          <div class="protocol-subtitle">ç”¨æˆ·æ•°æ®æŠ¥åè®®</div>
        </div>

        <div class="protocol-features">
          <div class="feature-item good">
            <div class="feature-icon">âœ“</div>
            <div class="feature-text">å¿«é€Ÿä¼ è¾“</div>
          </div>
          <div class="feature-item good">
            <div class="feature-icon">âœ“</div>
            <div class="feature-text">å¼€é”€å°</div>
          </div>
          <div class="feature-item good">
            <div class="feature-icon">âœ“</div>
            <div class="feature-text">æ— è¿æ¥</div>
          </div>
          <div class="feature-item good">
            <div class="feature-icon">âœ“</div>
            <div class="feature-text">æ”¯æŒå¤šæ’­</div>
          </div>
          <div class="feature-item bad">
            <div class="feature-icon">âœ—</div>
            <div class="feature-text">ä¸å¯é </div>
          </div>
          <div class="feature-item bad">
            <div class="feature-icon">âœ—</div>
            <div class="feature-text">å¯èƒ½ä¸¢åŒ…</div>
          </div>
        </div>

        <div class="protocol-example">
          <div class="example-title">åº”ç”¨åœºæ™¯</div>
          <div class="example-tags">
            <span class="tag">è§†é¢‘ç›´æ’­</span>
            <span class="tag">åœ¨çº¿æ¸¸æˆ</span>
            <span class="tag">è¯­éŸ³é€šè¯</span>
          </div>
        </div>

        <div class="handshake-demo">
          <div class="demo-title">ç›´æ¥å‘é€</div>
          <div class="handshake-steps">
            <div class="step direct">
              <div class="step-arrow">â†’</div>
              <div class="step-text">ç›´æ¥å‘é€æ•°æ®</div>
            </div>
          </div>
          <button class="demo-btn" @click="sendUdpData">
            {{ udpSent ? 'å†å‘ä¸€æ¬¡' : 'å‘é€æ•°æ®' }}
          </button>
        </div>
      </div>
    </div>

    <div class="comparison-table">
      <table>
        <thead>
          <tr>
            <th>ç‰¹æ€§</th>
            <th>TCP</th>
            <th>UDP</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>è¿æ¥</td>
            <td>é¢å‘è¿æ¥</td>
            <td>æ— è¿æ¥</td>
          </tr>
          <tr>
            <td>å¯é æ€§</td>
            <td>å¯é ï¼ˆç¡®è®¤é‡ä¼ ï¼‰</td>
            <td>ä¸å¯é ï¼ˆå°½æœ€å¤§åŠªåŠ›ï¼‰</td>
          </tr>
          <tr>
            <td>é€Ÿåº¦</td>
            <td>è¾ƒæ…¢</td>
            <td>å¾ˆå¿«</td>
          </tr>
          <tr>
            <td>å¼€é”€</td>
            <td>é«˜ï¼ˆ20å­—èŠ‚å¤´éƒ¨ï¼‰</td>
            <td>ä½ï¼ˆ8å­—èŠ‚å¤´éƒ¨ï¼‰</td>
          </tr>
          <tr>
            <td>æµé‡æ§åˆ¶</td>
            <td>æœ‰ï¼ˆæ»‘åŠ¨çª—å£ï¼‰</td>
            <td>æ— </td>
          </tr>
          <tr>
            <td>åº”ç”¨</td>
            <td>HTTP, FTP, SMTP, SSH</td>
            <td>DNS, DHCP, è§†é¢‘æµ</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="real-world-example">
      <div class="example-title">ğŸ¬ å®é™…åº”ç”¨ç¤ºä¾‹</div>
      <div class="scenario-grid">
        <div class="scenario">
          <div class="scenario-icon">ğŸ“º</div>
          <div class="scenario-name">è§†é¢‘ç›´æ’­</div>
          <div class="scenario-desc">
            ä½¿ç”¨ <strong>UDP</strong>ï¼Œå› ä¸ºï¼š <br />â€¢ ä¸¢å‡ å¸§æ²¡å…³ç³»ï¼Œå…³é”®æ˜¯å®æ—¶
            <br />â€¢ é‡ä¼ ä¼šé€ æˆå»¶è¿Ÿå’Œå¡é¡¿
          </div>
        </div>
        <div class="scenario">
          <div class="scenario-icon">ğŸŒ</div>
          <div class="scenario-name">ç½‘é¡µæµè§ˆ</div>
          <div class="scenario-desc">
            ä½¿ç”¨ <strong>TCP</strong>ï¼Œå› ä¸ºï¼š <br />â€¢ å†…å®¹å¿…é¡»å®Œæ•´å‡†ç¡® <br />â€¢
            ä¸¢å¤±ä»»ä½•æ•°æ®éƒ½ä¸å¯æ¥å—
          </div>
        </div>
        <div class="scenario">
          <div class="scenario-icon">ğŸ®</div>
          <div class="scenario-name">åœ¨çº¿æ¸¸æˆ</div>
          <div class="scenario-desc">
            ä½¿ç”¨ <strong>UDP</strong>ï¼Œå› ä¸ºï¼š <br />â€¢ å“åº”é€Ÿåº¦æ¯”å‡†ç¡®æ›´é‡è¦
            <br />â€¢ å®æ—¶åŒæ­¥ç©å®¶ä½ç½®
          </div>
        </div>
        <div class="scenario">
          <div class="scenario-icon">ğŸ“§</div>
          <div class="scenario-name">é‚®ä»¶å‘é€</div>
          <div class="scenario-desc">
            ä½¿ç”¨ <strong>TCP</strong>ï¼Œå› ä¸ºï¼š <br />â€¢ é‚®ä»¶å†…å®¹ä¸èƒ½ä¸¢å¤± <br />â€¢
            å¯é æ€§æ˜¯ç¬¬ä¸€è¦åŠ¡
          </div>
        </div>
      </div>
    </div>
  </div>
</template>

<script setup>
import { ref } from 'vue'

const tcpStep = ref(0)
const udpSent = ref(false)

const startTcpHandshake = () => {
  tcpStep.value = 0
  setTimeout(() => (tcpStep.value = 1), 500)
  setTimeout(() => (tcpStep.value = 2), 1200)
  setTimeout(() => (tcpStep.value = 3), 1900)
  setTimeout(() => {
    tcpStep.value = 0
  }, 4000)
}

const sendUdpData = () => {
  udpSent.value = true
  setTimeout(() => {
    udpSent.value = false
  }, 1000)
}
</script>

<style scoped>
.tcp-udp-comparison {
  border: 1px solid var(--vp-c-divider);
  border-radius: 6px;
  padding: 20px;
  background: var(--vp-c-bg-soft);
  margin: 20px 0;
}

.comparison-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 20px;
  margin-bottom: 25px;
}

@media (max-width: 768px) {
  .comparison-grid {
    grid-template-columns: 1fr;
  }
}

.protocol-card {
  background: var(--vp-c-bg);
  border: 2px solid var(--vp-c-divider);
  border-radius: 6px;
  padding: 20px;
}

.protocol-card.tcp {
  border-color: #e34c26;
}

.protocol-card.udp {
  border-color: #264de4;
}

.protocol-header {
  text-align: center;
  margin-bottom: 20px;
}

.protocol-icon {
  font-size: 3rem;
  margin-bottom: 10px;
}

.protocol-title {
  font-size: 1.5rem;
  font-weight: bold;
  color: var(--vp-c-text-1);
  margin-bottom: 5px;
}

.protocol-subtitle {
  font-size: 0.9rem;
  color: var(--vp-c-text-3);
}

.protocol-features {
  display: flex;
  flex-direction: column;
  gap: 8px;
  margin-bottom: 20px;
}

.feature-item {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 8px;
  border-radius: 6px;
  background: var(--vp-c-bg-soft);
}

.feature-item.good {
  border-left: 3px solid #22c55e;
}

.feature-item.bad {
  border-left: 3px solid #ef4444;
}

.feature-icon {
  font-weight: bold;
  font-size: 1rem;
}

.feature-text {
  font-size: 0.85rem;
  color: var(--vp-c-text-2);
}

.protocol-example {
  margin-bottom: 20px;
}

.example-title {
  font-size: 0.95rem;
  font-weight: bold;
  color: var(--vp-c-text-1);
  margin-bottom: 10px;
}

.example-tags {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
}

.tag {
  padding: 4px 12px;
  background: var(--vp-c-brand);
  color: white;
  border-radius: 12px;
  font-size: 0.75rem;
}

.handshake-demo {
  background: var(--vp-c-bg-soft);
  border-radius: 6px;
  padding: 15px;
}

.demo-title {
  font-size: 0.9rem;
  font-weight: bold;
  color: var(--vp-c-text-1);
  margin-bottom: 12px;
  text-align: center;
}

.handshake-steps {
  display: flex;
  flex-direction: column;
  gap: 8px;
  margin-bottom: 15px;
}

.step {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 8px;
  border-radius: 6px;
  opacity: 0.3;
  transition: opacity 0.3s;
}

.step.active {
  opacity: 1;
  background: var(--vp-c-bg);
}

.step.direct {
  opacity: 1;
  background: var(--vp-c-bg);
}

.step-arrow {
  font-size: 1.5rem;
  color: var(--vp-c-brand);
}

.step-text {
  font-size: 0.85rem;
  color: var(--vp-c-text-2);
}

.demo-btn {
  width: 100%;
  padding: 8px;
  background: var(--vp-c-brand);
  color: white;
  border: none;
  border-radius: 6px;
  font-size: 0.85rem;
  font-weight: 600;
  cursor: pointer;
  transition: background 0.2s;
}

.demo-btn:hover {
  background: var(--vp-c-brand-dark);
}

.comparison-table {
  background: var(--vp-c-bg);
  border-radius: 6px;
  padding: 20px;
  margin-bottom: 25px;
  overflow-x: auto;
}

table {
  width: 100%;
  border-collapse: collapse;
}

th,
td {
  padding: 12px;
  text-align: left;
  border-bottom: 1px solid var(--vp-c-divider);
}

th {
  font-size: 0.9rem;
  font-weight: bold;
  color: var(--vp-c-text-1);
  background: var(--vp-c-bg-soft);
}

td {
  font-size: 0.85rem;
  color: var(--vp-c-text-2);
}

tr:last-child td {
  border-bottom: none;
}

.real-world-example {
  background: var(--vp-c-bg);
  border-radius: 6px;
  padding: 20px;
}

.example-title {
  font-size: 1rem;
  font-weight: bold;
  color: var(--vp-c-text-1);
  margin-bottom: 15px;
}

.scenario-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 15px;
}

@media (max-width: 768px) {
  .scenario-grid {
    grid-template-columns: 1fr;
  }
}

.scenario {
  background: var(--vp-c-bg-soft);
  border-radius: 6px;
  padding: 15px;
}

.scenario-icon {
  font-size: 2rem;
  margin-bottom: 10px;
}

.scenario-name {
  font-size: 0.95rem;
  font-weight: bold;
  color: var(--vp-c-text-1);
  margin-bottom: 8px;
}

.scenario-desc {
  font-size: 0.8rem;
  color: var(--vp-c-text-2);
  line-height: 1.6;
}
</style>
