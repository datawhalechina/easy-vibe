<template>
  <div class="component-hierarchy-demo">
    <div class="demo-header">
      <span class="icon">ğŸŒ³</span>
      <span class="title">ç»„ä»¶å±‚çº§ç»“æ„</span>
      <span class="subtitle">åƒå®¶è°±æ ‘ä¸€æ ·çš„ç»„ä»¶å…³ç³»</span>
    </div>

    <div class="intro-text">
      æƒ³è±¡ä½ åœ¨<span class="highlight">å…¬å¸ç»„ç»‡æ¶æ„</span>å·¥ä½œï¼šCEOï¼ˆæ ¹ç»„ä»¶ï¼‰åœ¨é¡¶å±‚ï¼Œä¸‹é¢æ˜¯å„ä¸ªéƒ¨é—¨ï¼ˆçˆ¶ç»„ä»¶ï¼‰ï¼Œæ¯ä¸ªéƒ¨é—¨é‡Œè¿˜æœ‰å‘˜å·¥ï¼ˆå­ç»„ä»¶ï¼‰ã€‚è¿™å°±æ˜¯ç»„ä»¶æ ‘ï¼
    </div>

    <div class="demo-content">
      <div class="tree-container">
        <div class="tree-node root-node" :class="{ active: selectedNode === 'app' }" @click="selectNode('app')">
          <div class="node-icon">ğŸ‘‘</div>
          <div class="node-info">
            <div class="node-label">App (æ ¹ç»„ä»¶)</div>
            <div class="node-desc">CEO - ç®¡ç†å…¨å±€</div>
          </div>
        </div>

        <div class="tree-children">
          <div class="tree-branch">
            <div class="connector"></div>
            <div class="tree-node" :class="{ active: selectedNode === 'header' }" @click="selectNode('header')">
              <div class="node-icon">ğŸ“Œ</div>
              <div class="node-info">
                <div class="node-label">Header</div>
                <div class="node-desc">å¯¼èˆªæ éƒ¨é—¨</div>
              </div>
            </div>
          </div>

          <div class="tree-branch">
            <div class="connector"></div>
            <div class="tree-node" :class="{ active: selectedNode === 'main' }" @click="selectNode('main')">
              <div class="node-icon">ğŸ“„</div>
              <div class="node-info">
                <div class="node-label">Main Content</div>
                <div class="node-desc">ä¸»å†…å®¹éƒ¨é—¨</div>
              </div>
            </div>

            <div class="tree-children">
              <div class="tree-branch">
                <div class="connector"></div>
                <div class="tree-node" :class="{ active: selectedNode === 'sidebar' }" @click="selectNode('sidebar')">
                  <div class="node-icon">ğŸ“‘</div>
                  <div class="node-info">
                    <div class="node-label">Sidebar</div>
                    <div class="node-desc">ä¾§è¾¹æ å°ç»„</div>
                  </div>
                </div>
              </div>

              <div class="tree-branch">
                <div class="connector"></div>
                <div class="tree-node" :class="{ active: selectedNode === 'productlist' }" @click="selectNode('productlist')">
                  <div class="node-icon">ğŸ›ï¸</div>
                  <div class="node-info">
                    <div class="node-label">ProductList</div>
                    <div class="node-desc">å•†å“åˆ—è¡¨ç»„</div>
                  </div>
                </div>

                <div class="tree-children">
                  <div class="tree-branch">
                    <div class="connector"></div>
                    <div class="tree-node leaf" :class="{ active: selectedNode === 'productcard' }" @click="selectNode('productcard')">
                      <div class="node-icon">ğŸ·ï¸</div>
                      <div class="node-info">
                        <div class="node-label">ProductCard</div>
                        <div class="node-desc">å•†å“å¡ç‰‡å‘˜å·¥</div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="tree-branch">
            <div class="connector"></div>
            <div class="tree-node" :class="{ active: selectedNode === 'footer' }" @click="selectNode('footer')">
              <div class="node-icon">ğŸ”»</div>
              <div class="node-info">
                <div class="node-label">Footer</div>
                <div class="node-desc">é¡µè„šéƒ¨é—¨</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <Transition name="fade">
        <div v-if="selectedNodeInfo" class="node-details">
          <div class="detail-header">
            <span class="detail-icon">{{ selectedNodeInfo.icon }}</span>
            <span class="detail-title">{{ selectedNodeInfo.title }}</span>
          </div>
          <p class="detail-desc">{{ selectedNodeInfo.description }}</p>
          <div v-if="selectedNodeInfo.props || selectedNodeInfo.events" class="detail-info">
            <div v-if="selectedNodeInfo.props" class="info-section">
              <strong>ğŸ“¥ æ¥æ”¶:</strong>
              <span class="prop-tags">{{ selectedNodeInfo.props.join(', ') }}</span>
            </div>
            <div v-if="selectedNodeInfo.events" class="info-section">
              <strong>ğŸ“¤ è§¦å‘:</strong>
              <span class="prop-tags">{{ selectedNodeInfo.events.join(', ') }}</span>
            </div>
          </div>
        </div>
      </Transition>

      <div v-if="!selectedNode" class="hint-text">
        ğŸ‘† ç‚¹å‡»ä¸Šæ–¹ä»»æ„èŠ‚ç‚¹ï¼ŒæŸ¥çœ‹èŒè´£è¯´æ˜
      </div>
    </div>

    <div class="info-box">
      <span class="icon">ğŸ’¡</span>
      <strong>æ ¸å¿ƒæ€æƒ³ï¼š</strong>ç»„ä»¶åƒç»„ç»‡æ¶æ„ï¼Œçˆ¶ç»„ä»¶ç®¡ç†æ•´ä½“ï¼Œå­ç»„ä»¶è´Ÿè´£å…·ä½“åŠŸèƒ½ã€‚æ•°æ®ä»ä¸Šå¾€ä¸‹ä¼ ï¼Œäº‹ä»¶ä»ä¸‹å¾€ä¸ŠæŠ¥ã€‚
    </div>
  </div>
</template>

<script setup>
import { ref, computed } from 'vue'

const selectedNode = ref(null)

const nodeInfoMap = {
  app: {
    icon: 'ğŸ‘‘',
    title: 'App æ ¹ç»„ä»¶',
    description: 'å°±åƒå…¬å¸çš„CEOï¼Œè´Ÿè´£æ•´ä¸ªåº”ç”¨çš„åˆå§‹åŒ–å’Œå…¨å±€ç®¡ç†ã€‚åŒ…å«è·¯ç”±ã€å…¨å±€çŠ¶æ€ã€ä¸»é¢˜é…ç½®ç­‰å¤§æ–¹å‘å†³ç­–ã€‚',
    props: [],
    events: []
  },
  header: {
    icon: 'ğŸ“Œ',
    title: 'Header å¯¼èˆªæ ',
    description: 'å…¬å¸çš„å‰å°éƒ¨é—¨ï¼Œè´Ÿè´£å±•ç¤ºLogoã€å¯¼èˆªèœå•ã€ç”¨æˆ·ä¿¡æ¯å’Œè´­ç‰©è½¦ç­‰ã€‚å¤§éƒ¨åˆ†é¡µé¢éƒ½ä¼šç”¨åˆ°å®ƒã€‚',
    props: ['user', 'cartCount'],
    events: ['logout', 'search']
  },
  main: {
    icon: 'ğŸ“„',
    title: 'Main Content ä¸»å†…å®¹',
    description: 'å…¬å¸çš„æ ¸å¿ƒä¸šåŠ¡éƒ¨é—¨ï¼Œç®¡ç†é¡µé¢çš„ä¸»è¦å†…å®¹åŒºåŸŸã€‚ç”¨flexæˆ–gridå¸ƒå±€ç»„ç»‡ä¾§è¾¹æ å’Œå†…å®¹ã€‚',
    props: [],
    events: []
  },
  sidebar: {
    icon: 'ğŸ“‘',
    title: 'Sidebar ä¾§è¾¹æ ',
    description: 'å…¬å¸çš„å¯¼èˆªå°ç»„ï¼Œæä¾›å¯æŠ˜å çš„èœå•ã€‚å¸¸è§äºåå°ç®¡ç†ç³»ç»Ÿæˆ–åˆ†ç±»æµè§ˆé¡µé¢ã€‚',
    props: ['menuItems', 'collapsed'],
    events: ['select', 'toggle']
  },
  productlist: {
    icon: 'ğŸ›ï¸',
    title: 'ProductList å•†å“åˆ—è¡¨',
    description: 'å•†å“å±•ç¤ºå›¢é˜Ÿï¼Œè´Ÿè´£æ•°æ®è·å–ã€åˆ†é¡µã€æ’åºå’Œç­›é€‰ã€‚åŒ…å«å¤šä¸ªProductCardæˆå‘˜ã€‚',
    props: ['products', 'loading', 'total'],
    events: ['loadMore', 'sort', 'filter']
  },
  productcard: {
    icon: 'ğŸ·ï¸',
    title: 'ProductCard å•†å“å¡ç‰‡',
    description: 'æœ€åŸºå±‚çš„å‘˜å·¥ï¼Œè´Ÿè´£å±•ç¤ºå•ä¸ªå•†å“çš„ä¿¡æ¯ï¼ˆå›¾ç‰‡ã€åç§°ã€ä»·æ ¼ã€è¯„åˆ†ï¼‰ã€‚ä¸“æ³¨äºUIå±•ç¤ºã€‚',
    props: ['product', 'showAddToCart'],
    events: ['addToCart', 'click']
  },
  footer: {
    icon: 'ğŸ”»',
    title: 'Footer é¡µè„š',
    description: 'å…¬å¸çš„åå‹¤éƒ¨é—¨ï¼Œå±•ç¤ºç‰ˆæƒä¿¡æ¯ã€å‹æƒ…é“¾æ¥ã€è”ç³»æ–¹å¼ã€ç¤¾äº¤åª’ä½“é“¾æ¥ç­‰è¾…åŠ©ä¿¡æ¯ã€‚',
    props: [],
    events: []
  }
}

const selectedNodeInfo = computed(() => {
  return selectedNode.value ? nodeInfoMap[selectedNode.value] : null
})

const selectNode = (nodeId) => {
  selectedNode.value = selectedNode.value === nodeId ? null : nodeId
}
</script>

<style scoped>
.component-hierarchy-demo {
  border: 1px solid var(--vp-c-divider);
  border-radius: 6px;
  background: var(--vp-c-bg-soft);
  padding: 0.75rem;
  margin: 0.5rem 0;
  
  
}

.demo-header {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  margin-bottom: 0.75rem;
}

.demo-header .icon {
  font-size: 1.25rem;
}

.demo-header .title {
  font-weight: bold;
  font-size: 1rem;
}

.demo-header .subtitle {
  color: var(--vp-c-text-2);
  font-size: 0.85rem;
  margin-left: 0.5rem;
}

.intro-text {
  font-size: 0.9rem;
  color: var(--vp-c-text-2);
  line-height: 1.6;
  margin-bottom: 1rem;
  padding: 0.75rem;
  background: var(--vp-c-bg);
  border-radius: 6px;
}

.intro-text .highlight {
  color: var(--vp-c-brand-1);
  font-weight: 500;
}

.demo-content {
  background: var(--vp-c-bg);
  border-radius: 6px;
  padding: 0.75rem;
  margin-bottom: 0.75rem;
}

.tree-container {
  overflow-x: auto;
}

.tree-children {
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
  margin-top: 0.75rem;
  margin-left: 1.5rem;
}

.tree-branch {
  position: relative;
  display: flex;
  align-items: flex-start;
  gap: 0.75rem;
}

.connector {
  width: 16px;
  height: 2px;
  background: var(--vp-c-divider);
  margin-top: 18px;
  position: relative;
}

.connector::before {
  content: '';
  position: absolute;
  left: 0;
  top: -8px;
  width: 2px;
  height: 10px;
  background: var(--vp-c-divider);
}

.tree-node {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  padding: 0.75rem 1rem;
  background: var(--vp-c-bg-soft);
  border: 2px solid var(--vp-c-divider);
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.2s ease;
  min-width: 180px;
}

.tree-node:hover {
  border-color: var(--vp-c-brand);
  transform: translateX(4px);
}

.tree-node.active {
  border-color: var(--vp-c-brand);
  background: var(--vp-c-brand-soft);
  box-shadow: 0 0 0 3px var(--vp-c-brand-delta);
}

.root-node {
  background: linear-gradient(135deg, var(--vp-c-brand-soft), var(--vp-c-bg));
  border-width: 3px;
}

.leaf .node-icon {
  opacity: 0.8;
}

.node-icon {
  font-size: 1.25rem;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  background: var(--vp-c-bg);
  border-radius: 6px;
}

.node-info {
  display: flex;
  flex-direction: column;
}

.node-label {
  font-weight: 600;
  font-size: 0.875rem;
  color: var(--vp-c-text-1);
}

.node-desc {
  font-size: 0.75rem;
  color: var(--vp-c-text-2);
  margin-top: 0.15rem;
}

.node-details {
  margin-top: 1rem;
  padding: 0.75rem;
  background: var(--vp-c-bg-soft);
  border-radius: 6px;
  border: 1px solid var(--vp-c-divider);
}

.detail-header {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  margin-bottom: 0.5rem;
}

.detail-icon {
  font-size: 1.25rem;
}

.detail-title {
  font-weight: 600;
  font-size: 0.9rem;
  color: var(--vp-c-text-1);
}

.detail-desc {
  font-size: 0.875rem;
  color: var(--vp-c-text-2);
  line-height: 1.5;
  margin-bottom: 0.75rem;
}

.detail-info {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
}

.info-section {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-size: 0.8rem;
}

.info-section strong {
  color: var(--vp-c-text-1);
  flex-shrink: 0;
}

.prop-tags {
  color: var(--vp-c-brand);
  font-family: monospace;
  font-size: 0.75rem;
}

.hint-text {
  text-align: center;
  font-size: 0.85rem;
  color: var(--vp-c-text-3);
  margin-top: 0.75rem;
}

.fade-enter-active,
.fade-leave-active {
  transition: opacity 0.2s ease, transform 0.2s ease;
}

.fade-enter-from,
.fade-leave-to {
  opacity: 0;
  transform: translateY(-10px);
}

.info-box {
  background: var(--vp-c-bg-alt);
  padding: 0.75rem;
  border-radius: 6px;
  font-size: 0.85rem;
  color: var(--vp-c-text-2);
}

.info-box .icon {
  margin-right: 0.25rem;
}

@media (max-width: 768px) {
  .tree-node {
    min-width: auto;
  }

  .tree-children {
    margin-left: 1rem;
  }
}
</style>
